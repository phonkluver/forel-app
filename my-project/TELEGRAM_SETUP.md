# Настройка Telegram бота для уведомлений

## Текущая конфигурация

В файле `src/utils/telegram.ts` настроены следующие параметры:

```typescript
const TELEGRAM_BOT_TOKEN = '8227763242:AAFsuP_RUM2Ubh8IqYxVb9ZyI__lPuQkfho';
const ADMIN_CHAT_ID = '-4729513227';
```

## Что отправляется в Telegram

### 1. Бронирования столов
- Имя гостя
- Телефон
- Количество гостей
- Дата и время
- Время заявки

### 2. Заказы
- Состав заказа с количеством и ценами (всегда на русском языке)
- Общая сумма
- Способ оплаты
- Данные клиента (имя, телефон)
- Способ получения (доставка/самовывоз)
- Адрес доставки (если доставка)
- Комментарий к заказу
- **Подтверждение заказа отправляется клиенту в чат (всегда на русском языке)**

### Важно: Язык сообщений
- **Все сообщения админу**: Только на русском языке
- **Подтверждения клиенту**: Только на русском языке
- **Названия блюд**: Всегда на русском языке, независимо от выбранного языка в приложении



## Изменения в коде

### Отключен парсинг данных столиков
- Закомментированы функции `fetchAvailableTables` в `restoplace.ts`
- Закомментированы функции `fetchTables` и `submitReservation` в `api.ts`
- Закомментированы API роуты в `server.js` и `routers.ts`
- **Секция "Доступные столики" полностью удалена из формы бронирования**

### Добавлена отправка в Telegram
- Все формы теперь отправляют данные в Telegram бот админа
- Обновлены функции `submitReservation`, `checkout`
- Добавлены функции форматирования сообщений в `telegram.ts`

## Для изменения настроек

1. Измените `TELEGRAM_BOT_TOKEN` на токен вашего бота
2. Измените `ADMIN_CHAT_ID` на ID чата администратора

## Получение токена бота

1. Найдите @BotFather в Telegram
2. Отправьте команду `/newbot`
3. Следуйте инструкциям для создания бота
4. Скопируйте полученный токен

## Получение Chat ID

1. Добавьте бота в нужный чат
2. Отправьте сообщение в чат
3. Перейдите по ссылке: `https://api.telegram.org/bot<YOUR_BOT_TOKEN>/getUpdates`
4. Найдите `chat.id` в ответе

## Тестирование

Для тестирования отправки уведомлений:
1. Заполните форму бронирования
2. Оформите заказ
3. Проверьте получение уведомлений в Telegram
4. **Проверьте получение подтверждения заказа клиентом в чате**

## Как работает отправка клиенту

При оформлении заказа:
1. Данные заказа отправляются администратору
2. Получается Chat ID клиента из Telegram WebApp
3. Формируется подтверждение заказа с полным списком блюд
4. Подтверждение отправляется клиенту в чат
5. Клиент получает красивое сообщение с деталями заказа

## Автоматическое заполнение форм

### Профиль пользователя
- **Имя**: Автоматически подставляется из Telegram WebApp
- **Адрес доставки**: Сохраняется в localStorage и автоматически подставляется в формы
- **Редактирование адреса**: Пользователь может изменить адрес в профиле

### Формы заказа и бронирования
- **CheckoutComponent**: Автоматически заполняет имя и адрес из профиля
- **ReservationPage**: Автоматически заполняет имя из Telegram WebApp

## Логика доставки

### Зоны доставки
- **В городе**: 20 TJS
- **За городом**: Договорная цена

### Отображение цен
- **Корзина**: Показывает итоговую сумму с учетом доставки
- **Оформление заказа**: Позволяет выбрать зону доставки
- **Налог**: Убран из всех расчетов
- **Бесплатная доставка**: Отключена 